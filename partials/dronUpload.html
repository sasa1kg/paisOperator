<div class="container">
	<nav class="navbar navbar-default" ng-include="'partials/navigationBar.html'">
	</nav>

	<script type="text/ng-template" id="uploadRoundUp.html">
        <div>

            <!-- Modal content-->
            <div>
                <div class="modal-header">
                    <button type="button" class="close" ng-click="dismissModal()">&times;</button>
                    <h4 class="modal-title">{{ 'UPLOAD_OVERVIEW' | translate }}</h4>
                </div>
                <div class="modal-body" ng-show="bigImageError || configError">
	                <div class="alert alert-danger" ng-show="configError">
					  <strong>{{ 'ERROR_GEN' | translate }}</strong> {{ 'UPLOAD_NOT_KML' | translate }}
					</div>
					<div class="alert alert-danger" ng-show="bigImageError && imageFormat.length>0">
					  <strong>{{ 'ERROR_GEN' | translate }}</strong> {{ 'UPLOAD_FILE_NAME_ERROR' | translate }} <strong>{{imageFormat}}</strong>.
					</div>
					<div class="alert alert-danger" ng-show="bigImageError && imageFormat==''">
					  <strong>{{ 'ERROR_GEN' | translate }}</strong> {{ 'UPLOAD_DG_ERROR' | translate }}
					</div>
                </div>
                <div class="modal-body" ng-show="!bigImageError && !configError">
                	<h5><strong>{{ 'UPLOAD_CONFIG_FILE_TITLE' | translate }}</strong></h5>
                	<p ng-repeat="config in configFiles"><em>{{config.name}} {{roundDouble(config.size/1000)}} kb</em></p>
                	<hr>
                	<h5>{{ 'IMAGES' | translate }} {{imageFiles.length}}</h5>
                	<div class="tableHolder">
                	<table class="table table-bordered table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th>{{ 'IMAGE_NAME' | translate }}</th>
                                                            <th>{{ 'IMAGE_SIZE' | translate }}</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="success" ng-repeat="image in imageFiles">
                                                            <td><em>{{image.name}}</em></td>
                                                            <td>{{roundDouble(image.size/1000)}} kb</td>
                                                        </tr>
                                                    </tbody>
                    </table>
                    </div>
                    <hr>
                	<h5>{{ 'LARGE_IMAGES' | translate }} {{bigImageFiles.length}}</h5>
                	<div class="tableHolder">
                	<table class="table table-bordered table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th>{{ 'IMAGE_NAME' | translate }}</th>
                                                            <th>{{ 'IMAGE_SIZE' | translate }}</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="info" ng-repeat="image in bigImageFiles">
                                                            <td><em>{{image.name}}</em></td>
                                                            <td>{{roundDouble(image.size/1000)}} kb</td>
                                                        </tr>
                                                    </tbody>
                    </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-right btn-margin-right" ng-click="dismissModal()">{{ 'CANCEL' | translate }}</button>
                    <button type="button" class="btn btn-primary pull-right btn-margin-right" ng-disabled="bigImageError || configError" ng-click="saveChange()">{{ 'CONTINUE' | translate }}</button>
                </div>
            </div>
        </div>
    </script>

	<script type="text/ng-template" id="instructionModal.html">
        <div>

            <!-- Modal content-->
            <div>
                <div class="modal-header">
                    <button type="button" class="close" ng-click="dismissModal()">&times;</button>
                    <h4 class="modal-title">Instructions</h4>
                </div>
                <div class="modal-body">
                    <p>In this panel you should select and upload preprocessed large pictures (above 5mb). Due to practical restrictions in handling of large images, original large image need to be resized (downsampled) in reduced image of significantly smaller size. Suggested size of this reduced image is 2-3 MB. Upload panel <strong>must</strong> contain downgraded/reduced image with predefined image name (image_dg.png). </br>
						Beside this downgraded, reduced image, the tile images need to be created on basis 	of given assumed image grid. The size of tile images may vary, e.g. 2048px x 2048px, but only restriction is the image size. Preferred image size is again below 2 or 3 MB.  Each image tile <strong>must</strong> have a predefined name (image_0_0.png) where first digit after image name represents column and second digit represents row in the reduced image grid. </br>
                    <hr>
                    For example, if you want to upload large picture named <em>myImage.png</em> with dimensions showed bellow.</br>
                    <div class="text-center">
                    	<img class="examplePic" src="img/example1.PNG"></img></br>
                    </div>

                     First you create downgraded quality image named <em>myImage_dg.png</em>. After downgraded image has been created, you should proceed and create nxm grid of original-resolution, but smaller in size set of tile images. For example, with 1000px x 1000px grid cell size, equal to each tile image, original image <strong><u>myImage.png</u></strong> will be divided into 144 tile images. Note that end-tiles will be smaller in size (in this example there would be 11 1000x200, 11 1000x500 and 1 200x500px).
                     <div class="text-center">
                     	<img class="examplePic" src="img/example2.PNG"></img></br>
                     </div>

                      Every tile image <u><strong>must</strong></u> be named according to naming convention - marked slice must be named <em>myImage_1_1.png</em>.
                     <div class="text-center">
                     	<img class="examplePic" src="img/example3.PNG"></img></br>
                     </div>

                     Base image file <strong>must not contain</strong> following characters:</br>
                     - Point <strong>.</strong> </br> 
                     - Underscore <strong>_</strong> </br> 

                     <em>imageryBigSurface</em> is a valid name, where <em>imagery_Big_Surface</em> or <em>imagery.Big.Surface</em> are not. 
                     <hr>


                     If you have any doubt or misunderstanding of the procedure, contact the PAIS administrator before you start the upload procedure.

                     <hr>
                     <div class="alert alert-danger">
						<div class="checkbox">
						  <label><input type="checkbox" ng-model="instructionCheck"><strong>I have read and understood instructions for upload of large images and i will be held responsible for content, size and name of images in this upload form.</strong></label>
						</div>
					</div>

                    </p>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-right btn-margin-right" ng-click="dismissModal()">Cancel</button>
                    <button type="button" class="btn btn-primary pull-right btn-margin-right" ng-click="saveChange()">Save</button>
                </div>
            </div>
        </div>
    </script>


    <script type="text/ng-template" id="deleteModal.html">
        <div>

            <!-- Modal content-->
            <div>
                <div class="modal-header">
                    <button type="button" class="close" ng-click="dismissModal()">&times;</button>
                    <h4 class="modal-title">{{ 'DELETE_ALL' | translate }}</h4>
                </div>
                <div class="modal-body" ng-show="!loading">
	                <strong>{{ 'DELETE_Q' | translate }}</strong>
                </div>
                 <div class="modal-body" ng-show="loading">
                 	<div class="alert alert-info">
	                <strong>{{ 'Loading' | translate }}</strong>
	                </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-right btn-margin-right" ng-click="dismissModal()">{{ 'CANCEL' | translate }}</button>
                    <button type="button" class="btn btn-danger pull-right btn-margin-right" ng-disabled="loading" ng-click="delete()"><span class="glyphicon glyphicon-remove"></span> {{ 'DELETE_IMGS' | translate }}</button>
                </div>
            </div>
        </div>
    </script>

	<div class="col-lg-12">
		<a class="btn btn-danger pull-right" ng-click="clearImagesAndKMLs()"><span class="glyphicon glyphicon-remove"></span> {{ 'DELETE_BTN' | translate}}</a>
		<div class="panel panel-primary marginSep">
			<div class="panel-heading">
				<h3 class="panel-title">{{ 'UPLOADED' | translate}}</h3>
			</div>
			<div class="panel-body tableScroll">
				<table class="table table-bordered table-hover" ng-show="selectedDetailedImageResults.length > 0">
					<thead>
						<tr>
							<th>{{ 'UPLOADED_NAME' | translate}}</th>
							<th>{{ 'UPLOADED_DATE' | translate}}</th>
							<th>{{ 'UPLOADED_SIZE' | translate}}</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="image in selectedDetailedImageResults | filter : polygonFilter">
							<td>
								<div><a class="cursorchg" ng-click="imageLink(image.image_id, image.document_type)">{{image.document_name}}</a> <small ng-show="image.loading">{{ 'LOADING' | translate }}</small>
								</div>
							</td>
							<td>{{image.document_created_at}}</td>
							<td>{{roundFileSize(image.document_size)}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
			<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">{{ 'UPLOADED_KMLS' | translate}}</h3>
			</div>
			<div class="panel-body tableScroll">
				<table class="table table-bordered table-hover" ng-show="uploadedKmls.length > 0">
					<thead>
						<tr>
							<th>{{ 'UPLOADED_NAME' | translate}}</th>
							<th>{{ 'UPLOADED_DATE' | translate}}</th>
							<th>{{ 'UPLOADED_SIZE' | translate}}</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="kml in uploadedKmls">
							<td>{{kml.document_name}}</td>
							<td>{{kml.document_created_at}}</td>
							<td>{{roundFileSize(kml.document_size)}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>


		<div class="col-lg-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">{{ 'UPLOAD_CONF_TTL' | translate}} <p class="pull-right"><strong>{{ 'ONLY_KMLS' | translate }}<strong></p></h3>
				</div>
				<div class="panel-body">
					<button class="btn btn-primary" ngf-select="prepareConfig($files)">{{ 'UPLOAD_CONF' | translate}}</button>
					<br><br>
					<table class="table table-striped table-hover">
						<thead>
							<tr>
								<th>{{ 'FILE' | translate}}</th>
								<th>{{ 'PRG' | translate}}</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="f in configFile" style="font:smaller">
								<td>{{f.name}} {{f.$error}} {{f.$errorParam}}</td>
								<td><span class="progress" ng-show="f.progress >= 0">
									<div style="width:{{f.progress}}%"  
									ng-bind="f.progress + '%'"></div></td>
								</tr>
							</tbody>
							{{errorMsg}}
						</table>
					</div>
				</div>
			</div>

			<div class="col-lg-6">
				<div class="panel panel-primary">
					<div class="panel-heading">
						<h3 class="panel-title">{{ 'UPLOAD_DRON_TTL' | translate}} <p class="pull-right"><strong>{{ 'ONLY_IMAGES' | translate }}<strong></p></h3>
					</div>
					<div class="panel-body">
						<button class="btn btn-primary" ngf-select="prepareFiles($files)" multiple accept="image/*">{{ 'UPLOAD_DRON' | translate}}</button>
						<br><br>
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>{{ 'FILE' | translate}}</th>
									<th>{{ 'PRG' | translate}}</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="f in imageFiles" style="font:smaller">
									<td>{{f.name}} {{f.$error}} {{f.$errorParam}}</td>
									<td><span class="progress" ng-show="f.progress >= 0">
										<div style="width:{{f.progress}}%"  
										ng-bind="f.progress + '%'"></div></td>
									</tr>
								</tbody>
								{{errorMsg}}
							</table>
						</div>
					</div>                       
				</div>
				<div class="col-lg-12">
					<div class="panel panel-primary">
						<div class="panel-heading">
							<h3 class="panel-title">{{ 'UPLOAD_LG_IMAGES' | translate }} <p class="pull-right"><strong>{{ 'ONLY_LARGE_IMAGES' | translate }}<strong></p></h3>
						</div>
						<div class="panel-body tableScrollLarge">
							<div class="col-lg-3">
								<a class="btn btn-lg btn-danger full-btn" ng-click="showInstructionsModal()"><span class="glyphicon glyphicon-exclamation-sign"></span> {{ 'INSTR_MANUAL' | translate }}</a>
								<div class="alert alert-success instr_not" ng-show="instructionChecked">
								  <strong>{{ 'MANUAL_READ_ACCEPTED' | translate }}</strong>
								</div>
								<div class="alert alert-danger instr_not" ng-show="!instructionChecked">
								  <strong>{{ 'MANUAL_NOT_ACCEPTED' | translate }}</strong>
								</div>
							</div>
							<div class="col-lg-9" ng-hide="!instructionChecked">
								<button class="btn btn-primary" ngf-select="prepareLargeFiles($files)" multiple accept="image/*">{{'UPLOAD_LG_IMAGES' | translate }}</button>
								<br><br>
								<table class="table table-striped table-hover">
									<thead>
										<tr>
											<th>{{ 'FILE' | translate}}</th>
											<th>{{ 'PRG' | translate}}</th>
										</tr>
									</thead>
									<tbody>
										<tr ng-repeat="f in largeFiles" style="font:smaller">
											<td>{{f.name}} {{f.$error}} {{f.$errorParam}}</td>
											<td><span class="progress" ng-show="f.progress >= 0">
												<div style="width:{{f.progress}}%"  
												ng-bind="f.progress + '%'"></div></td>
											</tr>
										</tbody>
										{{errorMsg}}
									</table>
								</div>
							</div>
						</div>                       
					</div>
					<div class="col-lg-12">
						<div class="alert alert-success" ng-show="finishedImage">
							<strong>{{ 'SUCC' | translate }}!</strong> {{ 'SUCC_ALL_IMG' | translate}}  <a href="#/main" class="btn btn-primary"><span class="glyphicon glyphicon-chevron-left"></span> {{ 'BACK' | translate }}</a>
						</div>
						<a ng-click="showRoundUpModal()" class="btn btn-lg btn-primary pull-right" ng-disabled="configFile.length == 0 && (imageFiles.length == 0 || largeFiles.length == 0)"> {{ 'UPLOAD' | translate}} </a>
						<!-- <a ng-click="showRoundUpModal()" class="btn btn-lg btn-primary pull-right"> Test large </a> -->
					</div>


				</div>